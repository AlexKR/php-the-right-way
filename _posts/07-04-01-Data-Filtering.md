---
title: Фільтрування даних
isChild: true
---

## Фільтрування даних

Ніколи не довіряйте користувацькому вводу, котрий передається вашому PHP коду. Завжди перевіряйте і очищайте користувацький ввід, перед його використанням в коді. Функції `filter_var` і `filter_input` можуть очистити текст, а також перевірити відповідність вводу певним форматам тексту (наприклад адрес електронної пошти).

Користувацький ввід може бути будь яким: `$_GET` і `S_POST` дані внесені в форму, деякі значення в суперглобальній змінній `$_SERVER` і тіло HTTP запиту з допомогою `fopen('php://input`, 'r')`. Запам'ятайте, що користувацький ввід не обмежується лише даними форми, відправленої користувачем. Файли котрі відправляються і завантажуються, значення сесій, дані cookie і дані сторонніх веб сервісів, також прирівнюються до користувацького вводу.

Хоча користувацькі дані можуть бути без проблем збережені, скомбіновані і до них може бути отриманий доступ пізніше, та він все ще являється користувацьким вводом. Кожного разу, коли ви обробляєте, об'єднуєте чи підключаєте дані в ваш код, спитайте себе чи відфільтровані ці дані і чи можна їм довіряти.

Дані можуть бути _відфільтровані_ по-різному, в залежності від їх призначення. Наприклад, коли нефільтрований користувацький ввід передається в HTML код сторінки, він може виконати HTML і JavaScript на вашому сайті! Це відомо, як Cross-Site-Scripting (XSS) і може бути дуже небезпечним видом атаки. Один із способів уникнути XSS, полягає в валідації вводу від всіх HTML тегів (їх видаленням чи заміною на HTML символи).

Інший приклад - це передача даних для виконання командною строкою. Це може бути дуже небезпечно (і, як правило, це погана ідея), але ви можете використати вбудовану функцію `escapeshellarg` для валідації аргументів командної строки.

Останній приклад приймає користувацький ввід, щоб визначити, який файл завантажувати з файлової системи. Це може бути використано, для зміни імені файлу, на шлях файлу. Вам потрібно забрати "/", "../." [нульові байти][6] або інші символи із шляху файлу так, щоб він не міг завантажувати приховані, непублічні або конфіденційні файли.

* [Читати про фільтрацію даних][1]
* [Читати про `filter_var`][4]
* [Читати про `filter_input`][5]
* [Читати про обробку нульових байтів][6]

### Очистка

Очистка видаляє (або екранує) невірні або небезпечні символи із користувацького вводу.

Для прикладу, вам потрібно нормалізувати користувацький ввід, перед підключенням вводу в HTML або його вставкою в сирий запит SQL. Коли ви використовуєте звязані параметри з [PDO](#databases) вони будуть очищати ввід за вас.

Інколи потрібно дозволити деякі небезпечні HTML теги у вводі, включаючи його в HTML сторінку. Це дуже важко зробити і уникнути інших тегів, та це можна зробити, використовуючи обмежене форматування, як наприклад Markdown або BBCode тим не менше бібліотеки з білим переліком, як [HTML Purifier][html-purifier] існують саме для цього.

[Проглянути очищуючі фільтри][2]

### Валідація

Валідація гарантує, що користувацький ввід, являється тим, що ви очікуєте. Наприклад, ви можете валідувати: адрес електронної пошти, номер телефону або вік при обробці запиту реєстрації.

[Проглянути фільтри валідації][3]

[1]: http://www.php.net/manual/en/book.filter.php
[2]: http://www.php.net/manual/en/filter.filters.sanitize.php
[3]: http://www.php.net/manual/en/filter.filters.validate.php
[4]: http://php.net/manual/en/function.filter-var.php
[5]: http://www.php.net/manual/en/function.filter-input.php
[6]: http://php.net/manual/en/security.filesystem.nullbytes.php
[html-purifier]: http://htmlpurifier.org/
